{% extends "base.html" %} 
{% block content %}

<style>
.page-header {
    background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    padding: 50px 40px;
    border-radius: 16px;
    color: white;
    margin-bottom: 40px;
    box-shadow: 0 8px 32px rgba(245, 87, 108, 0.4);
    text-align: center;
}

.page-header h1 {
    margin: 0 0 15px 0;
    font-size: 2.8em;
    font-weight: 700;
    letter-spacing: -0.5px;
}

.page-header p {
    margin: 0;
    opacity: 0.95;
    font-size: 1.15em;
    font-weight: 300;
}

.back-link {
    display: inline-block;
    margin-bottom: 20px;
    color: rgba(255, 255, 255, 0.9);
    text-decoration: none;
    transition: all 0.3s ease;
    font-size: 0.95em;
}

.back-link:hover {
    opacity: 0.7;
    transform: translateX(-5px);
}
</style>

<div class="page-header">
    <a href="/" class="back-link">â† Retour Ã  l'accueil</a>
    <h1>ğŸ“Š Monitoring En Direct</h1>
    <p>Suivi en temps rÃ©el de vos niveaux de COâ‚‚</p>
</div>

<section class="card">
  <h2>Niveau de COâ‚‚</h2>
  <div class="value-wrapper">
    <span id="value" class="value">---</span>
    <svg id="trend" viewBox="0 0 24 24" aria-hidden="true">
      <path id="trend-path" d="M5 12 H19 M14 7 L19 12 L14 17" />
    </svg>
  </div>

  <div id="quality" class="quality">---</div>
  <div id="trend-info" style="margin-top: 8px; font-size: 0.9rem; color: #9ca3af;">---</div>

  <div style="margin-top: 20px; display: flex; gap: 10px; flex-wrap: wrap;">
    <button
      id="export"
      class="link btn-export"
    >
      ğŸ“¥ Exporter CSV
    </button>
    <a href="/settings" class="link">âš™ï¸ ParamÃ¨tres</a>
  </div>

  <div
    id="error-message"
    style="
      display: none;
      margin-top: 15px;
      padding: 10px;
      background: rgba(248, 113, 113, 0.15);
      border-radius: 6px;
      color: #f87171;
      font-size: 0.9rem;
    "
  ></div>
</section>

<section class="card">
  <div
    style="
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
      flex-wrap: wrap;
      gap: 10px;
    "
  >
    <h2 style="margin: 0">Historique</h2>
    <button
      id="reset-btn"
      style="
        padding: 8px 12px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid rgba(255, 255, 255, 0.15);
        border-radius: 6px;
        color: #9ca3af;
        cursor: pointer;
        font-weight: 500;
        transition: all 0.2s;
      "
      title="RÃ©initialiser le graphique"
    >
      âŸ² RÃ©initialiser
    </button>
  </div>
  <div class="chart-wrapper">
    <canvas id="chart"></canvas>

    <div id="paused-overlay" class="paused-overlay">
      <div class="paused-box">â¸ Analyse en pause</div>
    </div>
    <div id="sensor-overlay" class="sensor-overlay">
      <div class="sensor-box">âŒ Aucun capteur connectÃ©</div>
    </div>
  </div>

  <div
    style="
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 10px;
      font-size: 0.85rem;
      color: #9ca3af;
      flex-wrap: wrap;
      gap: 8px;
    "
  >
    <span id="time-range">Analyse en direct</span>
    <span id="data-points">Points: 0</span>
  </div>
</section>

<section class="card" id="alert-history-section" style="display: none;">
  <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
    <h2 style="margin: 0;">Historique des alertes</h2>
    <button 
      id="close-alerts" 
      style="
        background: none;
        border: none;
        color: #9ca3af;
        cursor: pointer;
        font-size: 1.2rem;
        padding: 0;
        width: 24px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
      "
    >âœ•</button>
  </div>
  <div id="alert-history-list" style="display: flex; flex-direction: column; gap: 10px; max-height: 400px; overflow-y: auto;">
    <div style="color: #9ca3af; text-align: center; padding: 20px;">Aucune alerte</div>
  </div>
</section>

<button 
  id="show-alerts-btn"
  style="
    position: fixed;
    bottom: 30px;
    left: 30px;
    width: 50px;
    height: 50px;
    border-radius: 50%;
    background: linear-gradient(135deg, #3dd98f, #4db8ff);
    border: none;
    color: #0a0e18;
    font-size: 1.2rem;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 15px rgba(61, 217, 143, 0.3);
    z-index: 1000;
    transition: all 0.3s ease;
  "
  title="Afficher l'historique des alertes"
>ğŸ””</button>

{% endblock %}
